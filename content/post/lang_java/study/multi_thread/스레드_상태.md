---
title: "[Java] 스레드 상태"
description: ""
date: "2022-10-06T21:40:30+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"


---
<!--more-->

- 스레드 객체를 생성한 경우
    - `start()` 메소드를 호출하면 곧바로 스레드가 실행되는 것처럼 보인다.
    - 사실은 실행 대기 상태가 된다.
    
    ### 실행 대기 상태
    
    - 아직 스케줄링이 되지 않아서 실행을 기다리고 있는 상태
    
    ### 실행(Running) 상태
    
    - 실행 대기 상태에 있는 스레드 중에서 스레드 스케줄링으로 선택된 스레드가 CPU를 점유하고 `run()` 메소드를 실행한 상태
    - 실행 상태의 스레드는 `run()` 메소드를 모두 실행하기 전에 스레드 스케줄링에 의해 다시 실행 대기 상태로 돌아 갈 수 있다.
        - 그리고 실행 대기 상태에 있는 다른 스레드가 선택되어 실행 상태가 된다.
- 스레드는 실행 대기 상태과 실행 상태를 번갈아가면서 자신의 `run()` 메소드를 조금씩 실행
    
    ### 종료 상태
    
    - 실행 상태에서 `run()` 메소드가 종료되면
        - 더 이상 실행할 코드가 없기 때문에 스레드의 실행은 멈추게 되는 상태
    
    ![Untitled](/images/lang_java/multi_thread/스레드_상태/Untitled.png)
    
- 경우에 따라서 스레드는 실행 상태에서 실행 대기 상태로 가지 않을 수도 있다.
    
    ### 일시 정지 상태
    
    - 실행 대기 상태에서 일시 정지 상태로 가기도 하는데,
        - 일시 정지 상태는 스레드가 실행할 수 없는 상태이다.
    - WAITING, TIMED_WAITING, BLOCKED
    - 스레드가 다시 실행 상태로 가기 위해서는 일시 정지 상태에서 실행 대기 상태로 가야만 한다.
    
    ![Untitled](/images/lang_java/multi_thread/스레드_상태/Untitled%201.png)
    
- 이러한 스레드의 상태를 코드에서 확인할 수있도록 하기 위해 자바 5부터 Thread 클래스에 `getState()` 메소드가 추가
    - getState() 메소드는 스레드 상태에서 `Thread.State` 열거 상수를 리턴
    
    ![Untitled](/images/lang_java/multi_thread/스레드_상태/Untitled%202.png)
    
- ex) 타깃 스레드의 상태를 출력하는 스레드
    - 스레드의 상태를 출력하는 StatePrintThread 클래스
    - 생성자 매개값으로 받은 타겟 스레드의 상태를 0.5초 주기로 출력
    - StatePrintThread.java
    
    ```java
    public class StatePrintThread extends Thread{
    	private Thread targetThread;
    	
    	public StatePrintThread(Thread targetThread) {
    		                   // 상태를 조사할 스레드
    		this.targetThread = targetThread;
    	}
    	
    	public void run() {
    		while(true) {
    			// 스레드 상태 얻기
    			Thread.State state = targetThread.getState();
    			System.out.println("targetThread state : " + state);
    			
    			// 객체 생성 상태일 경우 실행 대기 상태로 만듦
    			if(state == Thread.State.NEW) {
    				targetThread.start();
    			}
    			
    			// 종료 상태일 경우 while문을 종료
    			if(state == Thread.State.TERMINATED) {
    				break;
    			}
    			
    			try {
    				// 0.5초간 일시 정지
    				Thread.sleep(500);
    			}catch(Exception e) {}
    		}
    	}
    
    }
    ```
    
- ex) 타겟 스레드
    - 타겟 스레드 클래스
    - 10억 번 루핑을 돌게 해서 RUNNABLE 상태를 유지
    - `sleep()` 메소드를 호출해서 1.5초간 TIMED_WAITING 상태를 유지
    - 다시 10억 번 루핑을 돌게 해서 RUNNABLE 상태를 유지
    - TargetThread.java
    
    ```java
    public class TargetThread extends Thread{
    	public void run() {
    		for(long i = 0; i < 1000000000; i++) {}
    		
    		try {
    			// 1.5초간 일시 정지
    			Thread.sleep(1500);
    		}catch(Exception e) {}
    		
    		for(long i = 0; i< 1000000000; i++) {}
    	}
    
    }
    ```
    
    - TargetThread가 객체로 생성되면 NEW 상태를 가진다.
    - `run()` 메소드가 종료되면 TERMINATED 상태가 되므로 다음과 같은 상태로 변한다.
        
        ```java
        NEW -> RUNNABLE -> TIMED_WAITING -> RUNNABLE -> TERMINATED
        ```
        
- ex) 실행 클래스
    - StatePrintThread를 생성해서 매개값으로 전달받은 TargetThread의 상태를 출력하도록 작성된 실행 클래스
    - ThreadStateEx.java
    
    ```java
    public class ThreadStateEx {
    
    	public static void main(String[] args) {
    		StatePrintThread statePrintThread = 
    				new StatePrintThread(new TargetThread());
    		
    		statePrintThread.run();
    	}
    
    }
    ```
    
    ![Untitled](/images/lang_java/multi_thread/스레드_상태/Untitled%203.png)
    

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판