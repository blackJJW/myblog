---
title: "[Java] 스레드풀, 블로킹 방식의 작업 완료 통보"
description: ""
date: "2022-10-16T13:40:30+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"


---
<!--more-->

- ExecutorService의 `submit()` 메소드는 매개값으로 준 Runnable 또는 Callable 작업을 스레드풀의 작업 큐에 저장하고 즉시 Future 객체를 리턴
    
    ![Untitled](/images/lang_java/multi_thread/스레드풀,_블로킹_방식의_작업_완료_통보/Untitled.png)
    
    - Future 객체는 작업 결과가 아니라 작업이 완료될 때까지 기다렸다가(지연했다가 = 블로킹되었다가) 최종 결과를 얻는데 사용된다.
        - 그래서 Future를 지연 완료(pending completion) 객체라고도 한다.
    - Future의 get() 메소드를 호출하면 스레드가 작업을 완료할 때까지 블로킹되었다가 작업을 완료하면 처리 결과를 리턴
        - 이것이 블로킹을 사용하는 작업 완료 통보 방식
- Future가 가지고 있는 get() 메소드를 설명한 표
    
    
    | 리턴 타입 | 메소드명(매개 변수) | 설명 |
    | --- | --- | --- |
    | V | get() | 작업이 완료될 때까지 블로킹되었다가 처리 결과 V를 리턴 |
    | V | get(long timeout, TimeUnit unit) | timeout 시간 전에 작업이 완료되면 결과 V를 리턴하지만, 작업이 완료되지 않으면 TimeoutException을 발생시킴 |
    - 리턴 타입인 V는 `submit(Runnable task, V result)`의 두 번째 매개값인 V 타입이거나 `submit(Callable<V> task)`의 Callable 타입 파라미터 V 타입
- 다음 표는 세 가지 `submit()` 메소드별로 Future의 `get()` 메소드가 리턴하는 값이 무엇인지 보여준다.
    
    
    | 메소드 | 작업 처리 완료 후 리턴 타입 | 작업 처리 도중 예외 발생 |
    | --- | --- | --- |
    | submit(Runnable task) | future.get() -> null | future.get() -> 예외 발생 |
    | submit(Runnable task, Integer result) | future.get() -> int 타입 값 | future.get() -> 예외 발생 |
    | submit(Callable<String> task) | future.get() -> String 타입 값 | future.get() -> 예외 발생  |
- Future를 이용한 블로킹 방식의 작업 완료 통보에서 주의할 점
    - 작업을 처리하는 스레드가 작업을 완료하기 전까지는 `get()` 메소드가 블로킹 되므로 다른 코드를 실행할 수 없다.
    - `get()` 메소드를 호출하는 스레드는 새로운 스레드이거나 스레드풀의 또 다른 스레드가 되어야 한다.
    
    ![Untitled](/images/lang_java/multi_thread/스레드풀,_블로킹_방식의_작업_완료_통보/Untitled%201.png)
    
- Future 객체는 작업 결과를 얻기 위한 `get()` 메소드 이외에는 다음과 같은 메소드를 제공
    
    
    | 리턴 타입 | 메소드명(매개 변수) | 설명 |
    | --- | --- | --- |
    | boolean | cancel(boolean mayInterruptIfRunning) | 작업 처리가 진행 중일 경우 취소시킴 |
    | boolean | isCancelled() | 작업이 취소되었는지 여부 |
    | boolean | isDone() | 작업 처리가 완료되었는지 여부 |
    - cancel() 메소드는 작업을 취소하고 싶을 경우 호출 가능
        - 작업이 시작되기 전이라면 mayInterruptIfRunning 매개값과는 상관없이 작업 취소 후 true를 리턴
        - 작업 중이라면 mayInterruptIfRunning 매개값이 true일 경우에만 작업 스레드를 interrupt한다.
        - 작업이 완료되었을 경우 또는 어떤 이유로 인해 취소될 수 없다면 `cancel()` 메소드는 false를 리턴
    - `isCancelled()` 메소드는 작업이 완료되기 전에 작업이 취소되었을 경우에만 true를 리턴
    - `isDone()` 메소드는 작업이 정상적, 예외, 취소 등 어떤 이유에서건 작업이 완료되었다면 true를 리턴

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판