---
title: "[Java] 스레드풀, 리턴값이 있는 작업 완료 통보"
description: ""
date: "2022-10-24T22:40:30+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"


---
<!--more-->

- 스레드풀의 스레드가 작업을 완료한 후에 애플리케이션이 처리 결과를 얻어야 된다면 작업 객체를 Callable로 생성
- Callable 객체를 생성하는 코드
    - 주의할 점은 제네릭 타입 파라미터 `T`는 `call()` 메소드가 리턴하는 타입이 되도록 한다.
    
    ```java
    Callable<T> task = new Callable<T> {
    	@Override
    	public T call() throws Exception {
    		// 스레드가 처리할 작업 내용
    		return T;
    	}
    };
    ```
    
- Callable 작어의 처리 요청은 Runnable 작업과 마찬가지로 ExecutorService의 `submit()` 메소드를 호출
    - `submit()` 메소드는 작업 큐에 Callable 객체를 즉시 저장, 즉시 `Future<T>`를 리턴
        - `T`는 `call()` 메소드가 리턴하는 타입
    
    ```java
    Future<T> future = executorService.submit(task);
    ```
    
- 스레드풀의 스레드가 Callable 객체의 `call()` 메소드를 모두 실행하고 T타입의 값을 리턴할 경우
    - `Future<T>`의 `get()` 메소드는 블로킹이 해제되고 T타입의 값을 리턴
    
    ```java
    try{
    	T result = future.get();
    } catch (InterruptedException e){
    	// 작업 처리 도중 스레드가 interrupt 될 경우 실행할 코드
    } catch (ExecutionException e) {
    	// 작업 처리 도중 예외가 발생된 경우 실행할 코드
    }
    ```
    
- ex) 리턴값이 있는 작업 완료 통보
    - 1부터 10까지의 합을 리턴하는 작업을 Callable 객체로 생성
    - 스레드풀의 스레드가 처리하도록 요청
    - ResultByCallableEx.java
    
    ```java
    import java.util.concurrent.Callable;
    import java.util.concurrent.ExecutorService;
    import java.util.concurrent.Executors;
    import java.util.concurrent.Future;
    
    public class ResultByCallableEx {
    
    	public static void main(String[] args) {
    		ExecutorService executorService = Executors.newFixedThreadPool(
    				Runtime.getRuntime().availableProcessors()
    				);
    		
    		System.out.println("[ 작업 처리 요청 ]");
    		Callable<Integer> task = new Callable<Integer>() {
    			@Override
    			public Integer call() throws Exception{
    				int sum = 0;
    				for(int i = 1; i <= 10; i++) {
    					sum += i;
    				}
    				return sum;
    			}
    		};
    		Future<Integer> future = executorService.submit(task);
    		
    		try {
    			int sum = future.get();
    			System.out.println("[ 처리 결과 ] " + sum);
    			System.out.println("[ 작업 처리 완료 ]");
    		} catch(Exception e) {
    			System.out.println("[ 실행 예외 발생 ]" + e.getMessage());
    		}
    		
    		executorService.shutdown();
    
    	}
    
    }
    ```
    
    ![Untitled](/images/lang_java/multi_thread/스레드풀,_리턴값이_있는_작업_완료_통보/Untitled.png)
    

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판