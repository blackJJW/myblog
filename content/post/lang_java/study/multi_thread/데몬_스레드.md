---
title: "[Java] 데몬 스레드"
description: ""
date: "2022-10-12T23:40:30+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"


---
<!--more-->

- 데몬(daemon) 스레드는 주 스레드의 작업을 돕는 보조적인 역할을 수행하는 스레드
- 주 스레드가 종료되면 데몬 스레드는 강제적으로 자동 종료
    - 주 스레드의 보조 역할을 수행하므로 주 스레드가 종료되면 데몬 스레드의 존재 의미가 없어지기 때문
    - 이 점을 제외하면 데몬 스레드는 일반 스레드와 크게 차이가 없다.
- 스레드를 데몬으로 만들기 위해서는 주 스레드가 데몬이 될 스레드의 `setDaemon(true)`를 호출해주면 된다.
    - 아래 코드를 보면 메인 스레드가 주 스레드가 되고 AutoSaveThread가 데몬 스레드가 된다.
    
    ```java
    public static void main(String[] args) {
    	AutoSaveThread thread = new AutoSaveThread();
    	thread.setDaemon(true);
    	thread.start();
    	...
    }
    ```
    
    - 주의할 점은 `start()` 메소드가 호출되고 나서 `setDaemon(true)`를 호출하면 `IllegalThreadStateException`이 발생하기 때문에 `start()` 메소드 호출 전에 `setDaemon(true)`를 호출해야 한다.
- 현재 실행 중인 스레드가 데몬 스레드인지 아닌지를 구별하는 방법은 `isDaemon()` 메소드의 리턴값을 조사해보면 된다.
    - 데몬 스레드일 경우 true를 리턴
- ex) 1초 주기로 `save()` 메소드를 호출하는 데몬 스레드
    - 1초 주기로 save() 메소드를 자동 호출하도록 AutoSaveThread를 작성
    - 메인 스레드가 3초 후 종료되면 AutoSaveThread를 데몬 스레드로 만듦
    - AutoSaveThread.java
    
    ```java
    public class AutoSaveThread extends Thread{
    	public void save() {
    		System.out.println("작업 내용을 저장.");
    	}
    	
    	@Override
    	public void run() {
    		while(true) {
    			try {
    				Thread.sleep(1000);
    			} catch (InterruptedException e) {
    				break;
    			}
    			save();
    		}
    	}
    }
    ```
    
- ex) 메인 스레드가 실행하는 코드
    - DaemonEx.java
    
    ```java
    public class DaemonEx {
    
    	public static void main(String[] args) {
    		AutoSaveThread autoSaveThread = new AutoSaveThread();
    		autoSaveThread.setDaemon(true); // AutoSaveThread를 데몬 스레드로 만듦
    		autoSaveThread.start();
    		
    		try {
    			Thread.sleep(3000);
    		} catch (InterruptedException e) {
    		}
    		
    		System.out.println("메인 스레드 종료");
    
    	}
    }
    ```
    
    ![Untitled](/images/lang_java/multi_thread/데몬_스레드/Untitled.png)
    

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판