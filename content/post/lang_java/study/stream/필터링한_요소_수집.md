---
title: "[Java] 스트림, 필터링한 요소 수집"
description: ""
date: "2022-12-07T21:40:30+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"


---
<!--more-->

- 스트림은 요소들을 필터링 또는 매핑한 후 요소들을 수집하는 최종 처리 메소드인 `collect()`를 제공
    - 이 메소드를 이용하며 필요한 요소만 컬렉션으로 담을 수 있고, 요소들을 그룹핑한 후 집계(리덕션)할 수 있다.
 
## 필터링한 요소 수집
- Stream의 `collect(Collector<T, A, R> collector)` 메소드는 필터링 또는 매핑된 요소들을 새로운 컬렉션에 수집하고, 이 컬렉션을 리턴
    
    
    | 리턴 타입 | 메소드(매개 변수) | 인터페이스 |
    | --- | --- | --- |
    | R | collect(Collector<T, A, R> collector) | Stream |
    - 매개값인 `Collector(수집기)`는 어떤 요소를 어떤 컬렉션에 수집할 것인지를 결정
    - Collector의 타입 파라미터
        - T : 요소
        - A : 누적기(accumulator)
        - R : 요소가 저장될 컬렉션
        - T 요소를 A 누적기가 R에 저장한다는 의미
    
    ### Collector의 구현 객체
    
    - Collectors 클래스의 다양한 정적 메소드를 이용해 얻을 수 있다.
    
    ![Untitled](/images/lang_java/stream/필터링한_요소_수집/Untitled.png)
    
    - 리턴값인 Collector를 보면 A(누적기)가 `?`로 되어 있다.
        - Collector가 R(컬렉션)에 T(요소)를 저장하는 방법을 알고 있어 A(누적기)가 필요 없기 때문
    - `Map`과 `ConcurrentMap`의 차이점
        - `Map`은 스레드에 안전하지 않음
        - `ConcurrentMap`은 스레드에 안전
        - 멀티 스레드 환경에서 사용하려면 `ConcurrentMap`을 얻는 것이 좋다.
- ex) 전체 학생 중에서 남학생들만 필터링해서 별도의 List로 생성
    
    ```java
    1) Stream<Student> totalStream = totalList.stream();
    2) Stream<Student> maleStream = totalStream.filter(s->s.getSex()==Student.Sex.MALE);
    3) Collector<Student, ?, List<Student>> collector = Collectors.toList();
    4) List<Student> maleList = maleStream.collect(collector);
    ```
    
    1) 전체 학생 List에서 Stream을 얻는다.
    
    2) 남학생만 필터링해서 Stream을 얻는다.
    
    3) List에 Student를 수집하는 Collector를 얻는다.
    
    4) Stream에서 `collect()` 메소드로 Student를 수집해서 새로운 List를 얻는다.
    
    - 상기 코드에서 변수를 생략하면 다음과 같이 작성 가능
        
        ```java
        List<Student> maleList = totalList.stream()
        					.filter(s->s.getSex()==Student.Sex.MALE)
        					.collect(Collectors.toList());
        ```
        
- ex) 전체 학생 중에서 여학생들만 필터링해서 별도의 HashSet으로 생성
    
    ```java
    1) Stream<Student> totalStream = totalList.stream();
    2) Stream<Student> femaleStream = totalStream.filter(s->s.getSex()==Student.Sex.FEMALE);
    3) Supplier<HashSet<Student>> supplier = HashSet :: new;
    4) Collector<Student,?,HashSet<Student>> collector = Collectors.toCollection(supplier);
    5) Set<Student> femaleSet = femaleStream.collect(collector);
    ```
    
    1) 전체 학생 List에서 Stream을 얻는다.
    
    2) 여학생만 필터링해서 Stream을 얻는다.
    
    3) 새로운 HashSet을 공급하는 Supplier를 얻는다.
    
    4) Supplier가 공급하는 HashSet에 Student를 수집하는 Collector를 얻는다.
    
    5) Stream에서 `collect()` 메소드로 Student를 수집해서 새로운 HashSet을 얻는다.
    
    - 상기 코드에서 변수를 생략하면 다음과 같이 작성 가능
    
    ```java
    Set<Student> femaleSet = totalList.stream()
    					.filter(s -> s.getSex()==Student.Sex.FEMALE)
    					.collect(Collectors.toCollection(HashSet :: new));
    ```
    
- ex) 필터링해서 새로운 컬렉션 생성
    - ToListEx.java
    
    ```java
    import java.util.Arrays;
    import java.util.HashSet;
    import java.util.List;
    import java.util.Set;
    import java.util.stream.Collectors;
    
    public class ToListEx {
    
    	public static void main(String[] args) {
    		List<Student> totalList = Arrays.asList(
    				new Student("ABC", 10, Student.Sex.MALE),
    				new Student("DEF", 6, Student.Sex.FEMALE),
    				new Student("GHI", 10, Student.Sex.MALE),
    				new Student("JKL", 6, Student.Sex.FEMALE)
    		);
    		
    		// 남학생들만 묶어 List 생성
    		List<Student> maleList = totalList.stream()
    				.filter(s -> s.getSex() == Student.Sex.MALE)
    				.collect(Collectors.toList());
    		maleList.stream()
    			.forEach(s -> System.out.println(s.getName()));
    		
    		System.out.println();
    		
    		// 여학생들만 묶어 HashSet 생성
    		Set<Student> femaleSet = totalList.stream()
    				.filter(s -> s.getSex() == Student.Sex.FEMALE)
    				.collect(Collectors.toCollection(HashSet :: new));
    		femaleSet.stream()
    			.forEach(s -> System.out.println(s.getName()));
    
    	}
    }
    ```
    
    ![Untitled](/images/lang_java/stream/필터링한_요소_수집/Untitled%201.png)
    
- ex) 학생 클래스
    - Student.java
    
    ```java
    public class Student {
    	public enum Sex { MALE, FEMALE }
    	public enum City { Seoul, Pusan }
    	
    	private String name;
    	private int score;
    	private Sex sex;
    	private City city;
    	
    	public Student(String name, int score, Sex sex) {
    		this.name = name;
    		this.score = score;
    		this.sex = sex;
    	}
    	
    	public Student(String name, int score, Sex sex, City city) {
    		this.name = name;
    		this.score = score;
    		this.sex = sex;
    		this.city = city;
    	}
    	
    	public String getName() { return name; }
    	public int getScore() { return score; }
    	public Sex getSex() { return sex; }
    	public City getCity() { return city; }
    }
    ```
    

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판