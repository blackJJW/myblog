---
title: "[Java] JavaFX, 애니메이션"
description: ""
date: "2022-12-29T14:00:30+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"
  - "JavaFX"
---
<!--more-->

- JavaFX에서 애니메이션은 컨트롤 또는 컨테이너의 속성(property) 변화를 주어진 시간 동안 진행함으로써 구현
    
    ### 애니메이션과 관련된 클래스
    
    | 클래스 | 설명 |
    | --- | --- |
    | Timeline | KeyFrame에 설정된 내용대로 애니메이션을 진행시키는 객체 |
    | KeyValue | 타겟 속성(Property)과 종료값을설정하는 객체 |
    | KeyFrame | 애니메이션의 지속 시간과 KeyValue를 설정하는 객체(지속 시간 동안 타겟 속성의 값을 종료값까지 변화시킴) |
- translateX 속성을 주어진 종료값까지 변화시켜 수평 방향으로 슬라이드하는 애니메이션을 구현한 코드
    - 종료값은 x 좌표값
        - 음수, 0, 양수 값을 모두 가질 수 있다.
    
    ```java
    (1) Timeline timeline = new Timeline();
    (2) KeyValue keyValue = 
             new KeyValue(parent.translateXProperty(), 종료값);
    (3) KeyFrame keyFrame = 
             new KeyFrame(Duration.millis(지속시간), keyValue);
    (4) timeline.getKeyFrames().add(keyFrame);
    (5) timeline.play();
    ```
    
    (1) Timeline 객체를 생성
    
    (2) `translateXProperty()` 메소드로 값을 변화시킬 translateX 속성의 Property 객체를 얻고, 종료값을 지정해서 KeyValue 객체를 생성
    
    (3) 애니메이션 지속 시간(밀리 세컨드 단위)과 keyValue를 지정해서 KeyFrame을 생성
    
    (4) Timeline에 KeyFrame을 추가
    
    (5) Timeline을 플레이
    
- ex) 로그인 화면이 나올 때 우측에서 좌측으로 수평 애니메이션이 진행
    - RootController.java
    
    ```java
    import java.net.URL;
    import java.util.ResourceBundle;
    
    import javafx.animation.KeyFrame;
    import javafx.animation.KeyValue;
    import javafx.animation.Timeline;
    import javafx.event.ActionEvent;
    import javafx.fxml.FXML;
    import javafx.fxml.FXMLLoader;
    import javafx.fxml.Initializable;
    import javafx.scene.Parent;
    import javafx.scene.control.Button;
    import javafx.scene.layout.StackPane;
    import javafx.util.Duration;
    
    public class RootController implements Initializable {
    	@FXML private Button btnLogin;
    	
    	@Override
    	public void initialize(URL location, ResourceBundle resources) {
    		btnLogin.setOnAction( e -> handleBtnLogin(e) );
    	}
    	
    	public void handleBtnLogin(ActionEvent event) {
    		try {
    			// 로그인 화면으로 이동
    			Parent login = FXMLLoader.load(getClass().getResource("Login.fxml"));
    			StackPane root = (StackPane) btnLogin.getScene().getRoot();
    			root.getChildren().add(login);
    			
    			login.setTranslateX(350); // 시작값을 350으로 설정(로그인 화면의 폭)
    			
    			// 종료값을 0으로 설정하고, 0.1초간 지속
    			Timeline timeline = new Timeline();
    			KeyValue keyValue = new KeyValue(login.translateXProperty(), 0);
    			KeyFrame keyFrame = new KeyFrame(Duration.millis(100), keyValue);
    			timeline.getKeyFrames().add(keyFrame);
    			timeline.play();
    			
    		} catch(Exception e) {
    			e.printStackTrace();
    		}
    	}
    }
    ```
    
    - KeyFrame은 지속 시간 동안 속성을 종료값까지 변화시키고 나서 콜백 메소드를 자동 호출하는 기능을 가지고 있다.
        - 이 기능을 사용하려면 이벤트 핸들러를 추가해야 한다.
        
        ex) opacity 속성을 주어진 종료값까지 변화시켜 서서히 나타나고, 사라지는 페이드(fade) 애니메이션을 구현한 코드
        
        - 종료값은 투명도인데 0.0 ~ 1.0 범위의 값을 가진다.
        - 애니메이션이 종료되고 사여 콜백될 이벤트 핸들러를 추가
        
        ```java
        Timline timeline = new Timeline();
        KeyValue keyValue = 
                new KeyValue(parent.opacityProperty(), 종료값);
        KeyFrame keyFrame = new KeyFrame(
        	Duration.millis(지속시간),
        
        	// 애니메이션이 종료되면 handle() 메소드가 자동 호출됨
        	new EventHandler<ActionEvent>() {
        		@Override
        		public void handle(ActionEvent event) {
        			// 애니메이션이 종료 후 실행할 코드
        		}
        	},
        	keyValue
        );
        timeline.getKeyFrames().add(keyFrame);
        timeline.play();
        
        ```
        
    - LoginController.java
        - 로그인 화면 컨트롤러
        - 로그인 화면이 사라질 때 좌측에서 우측으로 애니메이션이 진행
        - 애니메이션이 종료 후에는 StackPane에서 로그인 화면을 완전히 제거
    
    ```java
    import java.net.URL;
    import java.util.ResourceBundle;
    
    import javafx.animation.KeyFrame;
    import javafx.animation.KeyValue;
    import javafx.animation.Timeline;
    import javafx.event.ActionEvent;
    import javafx.event.EventHandler;
    import javafx.fxml.FXML;
    import javafx.fxml.Initializable;
    import javafx.scene.control.Button;
    import javafx.scene.layout.BorderPane;
    import javafx.scene.layout.StackPane;
    import javafx.util.Duration;
    
    public class LoginController implements Initializable {
    	@FXML private BorderPane login;
    	@FXML private Button btnMain;
    	
    	@Override
    	public void initialize(URL location, ResourceBundle resources) {
    		btnMain.setOnAction( e -> handleBtnMain(e) );
    	}
    	
    	public void handleBtnMain(ActionEvent event) {
    		try {
    			StackPane root = (StackPane) btnMain.getScene().getRoot();
    			
    			login.setTranslateX(0); // 시작값을 0으로 설정
    			
    			// 종료값을 350으로 설정, 0.1초간 애니메이션 진행
    			Timeline timeline = new Timeline();
    			KeyValue keyValue = new KeyValue(login.translateXProperty(), 350);
    			KeyFrame keyFrame = new KeyFrame(
    					Duration.millis(100),
    					new EventHandler<ActionEvent>() {
    						@Override
    						public void handle(ActionEvent event) {
    							root.getChildren().remove(login); // 애니메이션 종료 후 로그인 화면 제거
    						}
    					},
    					keyValue
    				);
    			timeline.getKeyFrames().add(keyFrame);
    			timeline.play();
    			
    		} catch(Exception e) {
    			e.printStackTrace();
    		}
    	}
    }
    ```
    
    - Root.fxml
    
    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    
    <?import javafx.geometry.Insets?>
    <?import javafx.scene.control.Button?>
    <?import javafx.scene.control.Label?>
    <?import javafx.scene.layout.BorderPane?>
    <?import javafx.scene.layout.StackPane?>
    <?import javafx.scene.layout.VBox?>
    
    <StackPane prefHeight="500.0" prefWidth="350.0" 
               xmlns="http://javafx.com/javafx/19" 
               xmlns:fx="http://javafx.com/fxml/1"
               fx:controller="animation.RootController">
       <children>
          <BorderPane>
             <top>
                <BorderPane style="-fx-background-color: #eaeaea;">
                   <center>
                      <Label alignment="CENTER" prefWidth="215.0" text="메인 화면" />
                   </center>
                   <right>
                      <Button fx:id="btnLogin" mnemonicParsing="false" text="로그인" />
                   </right>
                   <padding>
                      <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                   </padding>
                </BorderPane>
             </top>
             <center>
                <VBox style="-fx-background-color: #0000ff;" />
             </center>
          </BorderPane>
       </children>
    </StackPane>
    ```
    
    - Login.fxml
    
    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    
    <?import javafx.geometry.Insets?>
    <?import javafx.scene.control.Button?>
    <?import javafx.scene.control.Label?>
    <?import javafx.scene.layout.BorderPane?>
    <?import javafx.scene.layout.VBox?>
    
    <BorderPane prefHeight="500.0" prefWidth="350.0" 
                xmlns="http://javafx.com/javafx/19" 
                xmlns:fx="http://javafx.com/fxml/1"
                fx:controller="animation.LoginController"
                fx:id="login">
       <top>
          <BorderPane style="-fx-background-color: #eaeaea;">
             <center>
                <Label prefWidth="215.0" text="로그인 화면" alignment="CENTER" />
             </center>
             <left>
                <Button fx:id="btnMain" text="메인"/>
             </left>
             <padding>
                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
             </padding>
          </BorderPane>
       </top>
       <center>
          <VBox style="-fx-background-color: #ffff00;" />
       </center>
    </BorderPane>
    ```
    
    - AppMain.java
    
    ```java
    import javafx.application.Application;
    import javafx.fxml.FXMLLoader;
    import javafx.scene.Parent;
    import javafx.scene.Scene;
    import javafx.stage.Stage;
    
    public class AppMain extends Application {
    	@Override
    	public void start(Stage primaryStage) throws Exception {
    		primaryStage.setTitle("AppMain");
    		Parent root = FXMLLoader.load(AppMain.class.getResource("Root.fxml"));
    		Scene scene = new Scene(root);
    		primaryStage.setScene(scene);
    		primaryStage.setWidth(350);  // 윈도우의 고정 폭 설정
    		primaryStage.setHeight(500); // 윈도우의 고정 높이 설정
    		primaryStage.setResizable(false); // 윈도우 크기를 조정할 수 없도록 함
    		primaryStage.show();
    	}
    
    	public static void main(String[] args) {
    		launch(args);
    	}
    }
    ```
    

![Untitled](/images/lang_java/javaFx/애니메이션/Untitled.png)

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판