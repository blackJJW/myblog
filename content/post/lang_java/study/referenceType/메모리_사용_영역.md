---
title: "[Java] 메모리 사용 영역"
description: ""
date: "2022-07-11T18:00:45+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"


---
<!--more-->

# JVM이 사용하는 메모리 영역

---

- java.exe로 JVM이 시작되면 JVM은 운영체제에서 할당받은 **메모리 영역(Runtime Data Area)을 세부 영역으로 구분**해서 사용

![Untitled](/images/lang_java/referenceType/메모리_사용_영역/Untitled.png)

# 메소드(Method) 영역

---

- 메소드 영역에는 코드에서 사용되는 클래스(~.class)들을 **클래스 로더로 읽어** 클래스별로 **런타임 상수 풀(runtime constant pool), 필드(field) 데이터, 메소드(method) 데이터, 메소드 코드, 생성자(constructor) 코드** 등을 **분류**해서 **저장**
    
    ## 힙(Heap) 영역
    
    ---
    
    - **객체와 배열이 생성**되는 영역
    - 힙 영역에 생성된 객체와 배열은 **JVM 스택 영역의 변수**나 **다른 객체의 필드**에서 **참조**
    - **참조하는 변수나 필드가 없는 경우**
        - **의미가 없는 객체**가 되어 garbage로 취급
        - JVM은 **Garbage Collector를 실행시켜 garbage 객체를 힙 영역에서 자동으로 제거**
    - 개발자는 객체를 제거하기 위해 **별도의 코드를 작성할 필요 없음**
    - 자바는 코드로 객체를 직접 제거시키는 방법을 제공하지 않음
    
    ## JVM Stack 영역
    
    ---
    
    - 각 스택 영역은 **각 스레드마다 하나씩 존재**하며 **스레드가 시작될 때 할당**
    - 자바 프로그램에서 추가적으로 스레드를 생성하지 않았다면 main 스레드만 존재하므로 JVM 스택도 하나이다.
    - JVM 스택은 **메소드를 호출할 때**마다 **프레임(Frame)을 추가(push)하고** **메소드가 종료되면 해당 프레임을 제거(pop)하는 동작**을 수행
    - **예외 발생 시**
        - `printStackTrace()` 메소드로 보여주는 **Stack Trace의 각 라인은 하나의 프레임을 표현**
    - 프레임 내부에는 **로컬 변수 스택**이 존재
        - **기본 타입 변수**와 **참조 타입 변수**가 추가(push)되거나 제거(pop)된다.
        - 변수가 이 영역에 생성되는 시점은 **초기화가 될 때**
            - **최초로 변수에 값이 저장**될 때
        - 변수는 선언된 블록 안에서만 **스택에 존재하고 블록을 벗어나면 스택에서 제거**된다.
        - ex)
            
            ```java
            // (1)
            char v1 = 'A';
            
            // (2)	
            if(v1 == 'A') {
            	int v2 = 100;
            	double v3 = 3.14;
            }
            
            // (3)
            boolean v4 = true;
            ```
            
            ![Untitled](/images/lang_java/referenceType/메모리_사용_영역/Untitled%201.png)
            
            - v2와 v3는 **if 블록 내부가 실행되고 있을 때만 스택 영역에 존재**하고 **실행 흐름이 if 블록을 빠져나가면 소멸**된다.
        - ex)
            
            ```java
            int[] scores = {10, 20, 30};
            ```
            
            - 기본 타입 변수는 스택 영역에 직접 값을 가지고 있지만, **참조 타입 변수는 값이 아니라 힙 영역이나 메소드 영역의 객체 주소를 가진다.**
            - 배열 변수인 scores는 스택 영역에 생성되지만 **실제 10, 20, 30을 갖는 배열은 힙 영역에 생성**
            - **배열 변수 scores에는 배열의 힙 영역의 주소가 저장**
            - 자바에서는 **배열을 객체로 취급**
            
            ![Untitled](/images/lang_java/referenceType/메모리_사용_영역/Untitled%202.png)
            

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판