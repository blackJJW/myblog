---
title: "[Java] 병렬 처리를 위한 컬렉션"
description: ""
date: "2022-11-20T01:30:30+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"


---
<!--more-->

- 동기화된(synchronized) 컬렉션은 멀티 스레드 환경에서 하나의 스레드가 요소를 안전하게 처리하도록 도와준다.
    - 전체 요소를 빠르게 처리하지는 못한다.
    - 하나의 스레드가 요소를 처리할 때 전체 잠금이 발생하여 다른 스레드는 대기 상태가 된다.
    - 멀티 스레드가 병렬적으로 컬렉션의 요소들을 처리할 수 없다.
- 자바는 멀티 스레드가 컬렉션의 요소를 병럴적으로 처리할 수 있도록 특별한 컬렉션을 제공
    - `java.util.concurrent` 패키지
        - `ConcurrentHashMap`
            - Map 구현 클래스
        - `ConcurrentLinkedQueue`
            - Queue 구현 클래스
- `ConcurrentHashMap`을 사용하면 스레드에 안전하면서도 멀티 스레드가 요소를 병렬적으로 처리 가능
    - `ConcurrentHashMap`은 부분(segment) 잠금을 사용하기 때문에 가능
    - ex) 컬렉션에 10개의 요소가 저장
        - 1개를 처리할 동안 전체 10개의 요소를 다른 스레드가 처리하지 못하도록 하는 것이 전체 잠금
        - 처리하는 용소가 포함된 부분만 잠금하고 나머지 부분은 다른 스레드가 변경할 수 있도록하는 것이 부분 잠금
    - `ConcurrentHashMap` 객체를 생성하는 코드
        - 사용하는 방법은 다른 Map 구현 객체와 마찬가지로 Map 인터페이스의 메소드를 호출하면 된다.
        
        ```java
        Map<K, V> map = new ConcurrentHashMap<K, V>();
        ```
        
- `ConcurrentLinkedQueue`는 락-프리(lock-free) 알고리즘을 구현한 컬렉션
    - 락-프리 알고리즘은 여러 개의 스레드가 동시에 접근할 경우
        - 잠금을 사용하지 않고도 최소한 하나의 스레드가 안전하게 요소를 저장하거나 얻도록 해준다.
    - `ConcurrentLinkedQueue`를 생성하는 코드
        - 사용하는 방법은 다른 Queue 구현 객체와 마찬가지로 Queue 인터페이스의 메소드를 호출하면 된다.
        
        ```java
        Queue<E> queue = new ConcurrentLinkedQueue<E>();
        ```
        

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판