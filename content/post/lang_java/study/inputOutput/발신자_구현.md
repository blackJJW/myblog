---
title: "[Java] UDP 네트워킹, 발신자 구현"
description: ""
date: "2023-01-23T11:00:30+09:00"
thumbnail: ""
categories:
  - "Java"
tags:
  - "Java"
  - "Network"
---
<!--more-->

- DatagramSocket 객체를 다음과 같이 생성
    
    ```java
    Datagram datagramSocket = new DatagramSocket();
    ```
    
    - 보내고자 하는 데이터를 `byte[]` 배열로 생성
        - 문자열인 경우 UTF-8로 인코딩해서 `byte[]` 배열을 얻으면 된다.
        
        ```java
        byte[] byteArr = data.getBytes("UTF-8");
        ```
        
    - 데이터의 수신자 정보를 담고 있는 DatagramPacket을 생성
        - 첫 번째 매개값 : 보낼 데이터인 `byte[]` 배열
        - 두 번째 매개값 : `byte[]` 배열에서 보내고자 하는 항목 수
            - 전체 항목을 보내려면 length 값으로 대입
        - 세 번째 매개값 : 수신자 IP와 포트 정보를 가지고 있는 SocketAddress
            - SocketAddress는 추상 클래스이므로 하위 클래스인 InetSocketAddress 객체를 생성해서 대입
        
        ex) 로컬 PC 5001번을 수신자로 하는 DatagramPacket을 생성하는 코드
        
        ```java
        byte[] byteArr = data.getBytes("UTF-8");
        DatagramPacket packet = new DatagramPacket(
        	byteArr, byteArr.length,
        	new InetSocketAddress("localhost", 5001)
        );
        ```
        
- DatagramPacket을 생성했다면
    - 이것을 매개값으로 해서 DatagramSocket의 `send()` 메소드를 호출하면 수신자에게 데이터가 전달
    
    ```java
    datagramSocket.send(packet);
    ```
    
    - 더 이상 보낼 데이터가 없을 경우
        - DatagramSocket을 닫기 위해 `close()` 메소드를 호출
    
    ```java
    datagramSocket.close();
    ```
    
- ex) 발신자 프로그램의 전체 코드
    - for문을 두 번 반복하는 데 각각 “메시지1”, “메시지2” 문자열을 전송
    - UdfSendEx.java
    
    ```java
    import java.net.DatagramPacket;
    import java.net.DatagramSocket;
    import java.net.InetSocketAddress;
    
    public class UdpSendEx {
    
    	public static void main(String[] args) throws Exception {
    		// Datagram Socket 생성
    		DatagramSocket datagramSocket = new DatagramSocket();
    		
    		System.out.println("[ 발신 시작 ]");
    		
    		for(int i = 1; i < 3; i++) {
    			String data = "메시지" + i;
    			byte[] byteArr = data.getBytes("UTF-8");
    			 
    			// DatagramPacket 생성
    			DatagramPacket packet = new DatagramPacket(
    				byteArr, byteArr.length,
    				new InetSocketAddress("localhost", 5001)
    			);
    			
    			// DatagramPacket 전송
    			datagramSocket.send(packet);
    			System.out.println("[ 보낸 바이트 수 ] : "
    					+ byteArr.length + " bytes");
    		}
    		
    		System.out.println("[ 발신 종료 ]");
    		
    		datagramSocket.close(); // DatagramSocket 닫기
    	}
    }
    ```
    
    ![Untitled](/images/lang_java/inputOutput/발신자_구현/Untitled.png)
    

---

## References

- 이것이 자바다 신용권의 Java 프로그래밍 정복 - 신용권 지음, 한빛미디어 출판